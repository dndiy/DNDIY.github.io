<script>
  // Props
  export let post;
  
  // Format date for display
  function formatDate(date) {
    return new Date(date).toLocaleDateString('en-US', {
      year: 'numeric',
      month: 'long',
      day: 'numeric'
    });
  }
</script>

<div class="card-base flex flex-col-reverse md:flex-col w-full rounded-[var(--radius-large)] overflow-hidden relative border-l-4 border-[var(--primary)]">
  <div class="pl-6 md:pl-9 pr-6 md:pr-2 pt-6 md:pt-7 pb-6 relative w-full">
    <!-- Friend indicator -->
    <div class="text-xs text-[var(--primary)] font-medium mb-2 flex items-center">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3 mr-1" viewBox="0 0 20 20" fill="currentColor">
        <path d="M9 6a3 3 0 11-6 0 3 3 0 016 0zM17 6a3 3 0 11-6 0 3 3 0 016 0zM12.93 17c.046-.327.07-.66.07-1a6.97 6.97 0 00-1.5-4.33A5 5 0 0119 16v1h-6.07zM6 11a5 5 0 015 5v1H1v-1a5 5 0 015-5z" />
      </svg>
      Friend Content
    </div>
    
    <!-- Title -->
    <a href={post.url} class="transition group w-full block font-bold mb-3 text-3xl text-90
      hover:text-[var(--primary)] dark:hover:text-[var(--primary)]
      active:text-[var(--title-active)] dark:active:text-[var(--title-active)]">
      {post.title}
      <svg xmlns="http://www.w3.org/2000/svg" class="inline text-[var(--primary)] text-[2rem] transition hidden md:inline absolute translate-y-0.5 opacity-0 group-hover:opacity-100 -translate-x-1 group-hover:translate-x-0" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M5 12h14M12 5l7 7-7 7"/>
      </svg>
    </a>
    
    <!-- Metadata -->
    <div class="flex flex-wrap gap-3 text-sm text-black/60 dark:text-white/60 mb-4">
      <div class="flex items-center">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 mr-1" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd" />
        </svg>
        {formatDate(post.published)}
      </div>
      
      {#if post.category}
      <div class="flex items-center">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 mr-1" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M17.707 9.293a1 1 0 010 1.414l-7 7a1 1 0 01-1.414 0l-7-7A.997.997 0 012 10V5a3 3 0 013-3h5c.256 0 .512.098.707.293l7 7zM5 6a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd" />
        </svg>
        {post.category}
      </div>
      {/if}
      
      {#if post.friendName}
      <div class="flex items-center">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 mr-1" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd" />
        </svg>
        {post.friendName}
      </div>
      {/if}
    </div>
    
    <!-- Description -->
    <div class="transition text-75 mb-3.5 pr-4 line-clamp-2">
      {post.description || ''}
    </div>
    
    <!-- Tags -->
    {#if post.tags && post.tags.length > 0}
    <div class="flex flex-wrap gap-2 mt-3">
      {#each post.tags as tag}
        <span class="text-xs bg-black/5 dark:bg-white/10 text-black/60 dark:text-white/60 px-2 py-1 rounded-md">
          {tag}
        </span>
      {/each}
    </div>
    {/if}
  </div>
  
  <!-- Image if available -->
  {#if post.image}
    <a href={post.url} aria-label={post.title} class="group max-h-[50vh] md:max-h-none mx-4 mt-4 -mb-2 md:mb-0 md:mx-0 md:mt-0 md:w-[28%] relative md:absolute md:top-3 md:bottom-3 md:right-3 rounded-xl overflow-hidden active:scale-95">
      <div class="absolute pointer-events-none z-10 w-full h-full group-hover:bg-black/30 group-active:bg-black/50 transition"></div>
      <div class="absolute pointer-events-none z-20 w-full h-full flex items-center justify-center">
        <svg xmlns="http://www.w3.org/2000/svg" class="transition opacity-0 group-hover:opacity-100 scale-50 group-hover:scale-100 text-white text-5xl" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M5 12h14M12 5l7 7-7 7"/>
        </svg>
      </div>
      <img src={post.image} alt={post.title} class="w-full h-full object-cover" />
    </a>
  {/if}
</div>